---
title: "soybean_WGD"
output: html_document
date: "2024-10-03"
---

```{r load the libraries}
library(dplyr)
library(ggplot2)
library(tidyr)
```

```{r duplicated gene pairs}
#load the gene pairs generated by the programs 
wgd<-read.delim2("Gma.wgd.pairs_no_scaffold")
wgd$duplication_status<-rep("WGD",34378)

td<-read.delim2("Gma.tandem.pairs_no_scaffold")
td$duplication_status<-rep("TD",2639)

pd<-read.delim2("Gma.proximal.pairs_no_scaffold")
pd$duplication_status<-rep("PD",1520)

trd<-read.delim2("Gma.transposed.pairs_no_scaffold")
trd$duplication_status<-rep("TRD",4815)
colnames(trd)<-colnames(wgd)

dsd<-read.delim2("Gma.dispersed.pairs_no_scaffold")
dsd$duplication_status<-rep("DSD",30693)

glyma_duplicated_pairs<-rbind(wgd,td,pd,trd,dsd)

#remove the duplicated rows in the files, not sure how these rows come from, but we need to remove them for following analysis. 
glyma_duplicated_pairs_unique<-glyma_duplicated_pairs[!duplicated(glyma_duplicated_pairs),]
glyma_duplicated_pairs_duplicated<-glyma_duplicated_pairs[duplicated(glyma_duplicated_pairs),]

glyma_duplicated_pairs_unique$Combined <- paste(glyma_duplicated_pairs_unique$Duplicate.1, glyma_duplicated_pairs_unique$Duplicate.2, sep = "_")

length(unique(glyma_duplicated_pairs_unique$Combined))

#write.csv(glyma_duplicated_pairs_unique, "glyma_duplicated_pairs_unique.csv")

#summary the amount of the different duplicate pairs for each catagory 
summary_glyma_duplicated_pairs_unique_counts <- glyma_duplicated_pairs_unique %>%
  count(duplication_status)

#glyma_duplicated_pairs_unique_wgd<-glyma_duplicated_pairs_unique[glyma_duplicated_pairs_unique$duplication_status == "WGD",]

```


```{r duplicated genes}
#summary the genes, originating from different categories 
Duplicate1<-glyma_duplicated_pairs_unique[,c("Duplicate.1","duplication_status")]
colnames(Duplicate1) <- c("Dup","duplication_status")
Duplicate2<-glyma_duplicated_pairs_unique[,c("Duplicate.2","duplication_status")]
colnames(Duplicate2) <- c("Dup","duplication_status")
Duplicated_genes<-rbind(Duplicate1,Duplicate2)

#summary the genes, removing the duplicates 
Duplicated_genes_wgd<-Duplicated_genes[Duplicated_genes$duplication_status == "WGD",]
Duplicated_genes_wgd_unique<-unique(Duplicated_genes_wgd)

Duplicated_genes_td<-Duplicated_genes[Duplicated_genes$duplication_status == "TD",]
Duplicated_genes_td_unique<-unique(Duplicated_genes_td)

Duplicated_genes_pd<-Duplicated_genes[Duplicated_genes$duplication_status == "PD",]
Duplicated_genes_pd_unique<-unique(Duplicated_genes_pd)

Duplicated_genes_trd<-Duplicated_genes[Duplicated_genes$duplication_status == "TRD",]
Duplicated_genes_trd_unique<-unique(Duplicated_genes_trd)

Duplicated_genes_dsd<-Duplicated_genes[Duplicated_genes$duplication_status == "DSD",]
Duplicated_genes_dsd_unique<-unique(Duplicated_genes_dsd)

Duplicated_genes_unique <- Duplicated_genes[!duplicated(Duplicated_genes$Dup), ]

write.csv(Duplicated_genes_unique, "Duplicated_genes_unique.csv")
write.csv(Duplicated_genes, "Duplicated_genes_all.csv")

#write.csv(Duplicated_genes_dsd_unique, "Duplicated_genes_dsd_unique.csv")
#write.csv(Duplicated_genes_td_unique, "Duplicated_genes_td_unique.csv")
#write.csv(Duplicated_genes_pd_unique, "Duplicated_genes_pd_unique.csv")
#write.csv(Duplicated_genes_trd_unique, "Duplicated_genes_trd_unique.csv")
#write.csv(Duplicated_genes_wgd_unique, "Duplicated_genes_wgd_unique.csv")


glyma_genes<-read.delim2("glyma_gene_list", header=FALSE)
colnames(glyma_genes) <- "Dup"

sc <- glyma_genes %>% anti_join(Duplicated_genes_unique, by = "Dup")
#write.csv(sc,"sc_genes.csv")
```


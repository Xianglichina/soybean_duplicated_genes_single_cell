########## divergent gene expression analysis within tissue ##########
### step 1. clean the raw gene count for each tissue in R ###
Recorder the columns and remove the columns without two duplicates (make sure that at least two replicates for each cell type). 
Conduct correlation test between the two replicates using Spearman test. Only keep the replicates that with the correlation > 0.75

#input_file: Gm_atlas_Early_maturation_RNA_gene_celltype_splitReps_counts.txt
#output_file: early_maturation_reorder.csv
#script: reorder_gene_counts.Rmd

### step 2. normalize the gene count ###
This pseudo bulk single cell data can be treated as nromal bulk data
normalize the genes across different cell types within the same tissue and filtered the lowly expressed genes 

#input_file: early_maturation_reorder.csv
#output_file: early_maturation_filter_normalized.csv
#script: normalization_edgeR.Rmd

### step 3. extract the expression gene counts for each duplicated gene pairs with two replicates using python ###
#input_files: early_maturation_filter_normalized.csv  07042025_glyma_duplicated_pairs.csv (unique duplicated gene pairs from above steps)
#output_file: early_maturation_pairs.csv 
#script: extract_duplicates_expression.py 
#commend: python extract_duplicates_expression.py  early_maturation_filter_normalized.csv 07042025_glyma_duplicated_pairs.csv early_maturation_filter_pairs.csv 

### step 4. filter the duplicated pairs with no expression in both genes ###
#input_file: early_maturation_filter_pairs.csv
#output_file: 
expressed_early_maturation_pairs_expression_separated_raw.csv (this file contain the gene pairs with the two gene IDs separated as two columns and the expression of the duplicated genes)
expressed_early_maturation_pairs_expression_separated.csv (this file only contains the information of gene pairs and the two gene IDs)
#script: filtered_gene_pairs.Rmd

### step 5. generate coexpression network:get_coexp_network_no_filter.r  ###
#input_file: early_maturation_filter_normalized.csv (normalized and filetered gene counts)
#output_file: early_maturation_filter_coexp_network.Rdata (co-expression_network)
#script: Rscript get_coexp_network_filter.r
#commend: Rscript get_coexp_network_filter.r  early_maturation_filter_normalized.csv (run this commend in the cluster) 

### step 6. generate paralog coexpression csv file: get_paralog_coexpression.r ###
#input_file: expressed_early_maturation_pairs_expression_separated.csv (this sheet includes the gene pairs with some expression, removing the ones not expressed in both genes)
#output_file: early_maturation_filter_coexp_network_paralog_pair_coexpression.csv 
#script: get_paralog_coexpression.r 
#commend: Rscript get_paralog_coexpression.r  expressed_early_maturation_pairs_expression_separated.csv early_maturation_filter_coexp_network.Rdata (run this commend in the cluster) 

### step 7. calculate expression fold change. This step should be able to finish in the local computer ###
#input_file:
early_maturation_filter_normalized.csv
early_maturation_paralog_pair_coexpression.csv
#output_file: early_maturation_paralog_pair_coexpression_fold_change.csv
#script:calculate_expression_fold_change.RMD

The NA in the sheet should be the pairs that with one gene expressed but the others not. 

### step 8. characterize the expression of gene pairs ###
#aim1:summarize different types of expression within each tissues types
[category1] mono-expressed
[category2] dosage balance
[category3] paralogue dominance
[category4] specialized
[category5] diverged

#aim2:figure out the gene pair with mono-expressed pattern, which gene is expressed and which gene is not. 

#aim3:combine the expression pattern across tissue types for each gene pair for further across tissue analyese. 


#input_file:
early_nodule_filter_paralog_pair_coexpression_fold_change.csv
07042025_glyma_duplicated_pairs.csv

#output_file: 
presentation_early_nodule_expression_type_final_all.csv

#script:
0715_charaterization_gene_pair_expression_within_tissue.Rmd

#script (generate the supplementary table for summarizing the expression patterns withiin the tissues) 
0715_summary_expression_types_within_tissues.Rmd

########## divergent gene expression analysis within tissue ##########
#load the combined expression patterns across tissue for each gene pair
#calculate the expression stability across stages or across tissues 

#input_file: 07152025_combined_expression_patterns.csv

#script:07152025_expression_stability.Rmd




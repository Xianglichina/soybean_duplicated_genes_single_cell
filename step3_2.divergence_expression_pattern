##########################################################################################################################################
part1:figure out the consistence of the genes expressed in mono-expressed gene pairs across tissues.
##########################################################################################################################################
###step1. filter mono_expressed as the gene ID for the gene expressed in the mono-expressed gene pair### 
#input files
07152025_combined_expression_patterns.csv (combined expression patterns across tissues)

(The following are the expressed genes in mono-expressed gene pairs for each tissue)
cotyledon_filter_one_expression_expressed.csv 
early_maturation_filter_one_expression_expressed.csv
early_nodule_filter_one_expression_expressed.csv
globular_filter_one_expression_expressed.csv
heart_filter_one_expression_expressed.csv
hypocotyl_filter_one_expression_expressed.csv
root_filter_one_expression_expressed.csv

#output_files:
0808_combined_mono_expressed_patterns.csv

#script: 
step1.replace_mono_expressed.py

#commend:
python step1.replace_mono_expressed.py 07152025_combined_expression_patterns.csv cotyledon_filter_one_expression_expressed.csv early_nodule_filter_one_expression_expressed.csv early_maturation_filter_one_expression_expressed.csv globular_filter_one_expression_expressed.csv heart_filter_one_expression_expressed.csv hypocotyl_filter_one_expression_expressed.csv root_filter_one_expression_expressed.csv 0808_combined_mono_expressed_patterns.
csv

###step2. summarize whether the same or different expressed genes in mono_expressed gene pairs across tissues### 
#input_files:
0808_combined_mono_expressed_patterns.csv

#output_files:
0808_summary_mono_expressed.csv

#script:
step2.summary_mono.py

#commend:
python step2.summary_mono.py 0808_combined_mono_expressed_patterns.csv 0808_summary_mono_expressed.csv

###step3. make the plots for the distribution of mono_expressed gene pairs with the same or different gene expressed across tissues### 
#input_files:
0808_summary_mono_expressed.csv

#output_file:
plot_mono_expression_across_tissues.pdf

#script:
step3.mono_expression_7_tissue.Rmd

##########################################################################################################################################
part2:stability score calculation across stages and across tissues.
##########################################################################################################################################
#input_file:
07152025_combined_expression_patterns.csv

#output_files:
write.csv(stability_scores_full, "07292025_stability_scores_full.csv")
write.csv(stage_summary,"08022025_stage_summary.csv")
write.csv(tissue_summary,"08022025_tissue_summary.csv")
write.csv(core_stages_dup,"08022025_stage_dup_summary.csv")
write.csv(core_tissues_dup,"08022025_tissue_dup_summary.csv")

#script:
08052025_expression_stability.Rmd

#across tissues and across stages
stage_cols <- c("expression_type_cotyledon", "expression_type_early_maturation",
                "expression_type_globular", "expression_type_heart")
tissue_cols <- c("expression_type_hypocotyl", "expression_type_root", "expression_type_early_nodule","expression_type_heart")

#consolidated expression patterns 
pattern_map <- c(
  "dosage_balance" = "correlated_expression",
  "paralogue_dominance" = "correlated_expression",
  "specialized" = "correlated_expression",
  "diverged" = "uncorrelated_expression",
  "others" = "uncorrelated_expression",
  "mono_expressed" = "mono_expression",
  "not_expressed" = "non_expression"
)







